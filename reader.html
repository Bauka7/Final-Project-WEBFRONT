<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title id="page-title">ReadOwl – Reader</title>
  <link rel="stylesheet" href="readerstyle.css"/>
</head>
<body class="reader-page">
  <header class="reader-bar">
    <a class="reader-bar__back" href="book.html?id=" id="back-link">‹ Back</a>
    <span class="reader-bar__title" id="book-name"></span>
  </header>

  <main class="reader-main">
    <embed id="pdf-viewer" src="" type="application/pdf" class="reader-embed"/>
  </main>

  <script>
    const catalog = {
      b1: { file: "pdf-books/atomic-habits.pdf", title: "Atomic Habits" },
      b2: { file: "pdf-books/dune.pdf", title: "Dune" },
      b3: { file: "pdf-books/clean-code.pdf", title: "Clean Code" },
      b4: { file: "", title: "The Midnight Library" },
      b5: { file: "", title: "Klara and the Sun" },
      b6: { file: "", title: "The Psychology of Money" },
      b7: { file: "", title: "Thinking, Fast and Slow" }
    };

    const id = new URLSearchParams(location.search).get("id");
    const storedBooks = (() => {
      try {
        return JSON.parse(localStorage.getItem("readowl.libraryBooks") || "[]");
      } catch {
        return [];
      }
    })();

    const storedMatch = storedBooks.find((book) => book.id === id);
    const fallback = catalog[id] || catalog.b1;
    const title = storedMatch?.title || fallback.title;
    const file = storedMatch?.pdfFile || fallback.file;

    document.getElementById("page-title").textContent = `ReadOwl – ${title}`;
    document.getElementById("book-name").textContent = title;
    document.getElementById("back-link").href += id || "b1";
    document.getElementById("pdf-viewer").src = file || fallback.file;
  </script>
</body>
</html>